const showYear=(()=>{const t=document.querySelector(".year"),e=(new Date).getFullYear();t.textContent=e})(),Storage={clearAllItems:()=>{let t=JSON.parse(localStorage.getItem("keepSt"));t.length=0,localStorage.setItem("keepSt",JSON.stringify(t))},deleteItem:t=>{let e=JSON.parse(localStorage.getItem("keepSt"));e.forEach((r,i)=>{r.id==t.id&&e.splice(i,1)}),localStorage.setItem("keepSt",JSON.stringify(e))},updateItem:t=>{let e=JSON.parse(localStorage.getItem("keepSt"));e.forEach((r,i)=>{r.id==t.id&&e.splice(i,1,t)}),localStorage.setItem("keepSt",JSON.stringify(e))},getItemFromStorage:()=>{let t;return t=null===localStorage.getItem("keepSt")?[]:JSON.parse(localStorage.getItem("keepSt")),t},addItemToStorage:t=>{let e;null===localStorage.getItem("keepSt")?(e=[],e.push(t),localStorage.setItem("keepSt",JSON.stringify(e))):(e=JSON.parse(localStorage.getItem("keepSt")),e.push(t),localStorage.setItem("keepSt",JSON.stringify(e)))}},DataCtr=(()=>{const t=function(t,e,r){this.id=t,this.name=e,this.price=r},e={items:Storage.getItemFromStorage(),currentItem:null,totalSales:0};return{clearAll:()=>{e.items.length=0},deleteItem:t=>{e.items.forEach((r,i)=>{r.id===t&&e.items.splice(i,1)})},updateItem:(t,r)=>{let i;return r=parseInt(r),e.items.forEach(a=>{a.id===e.currentItem.id&&(a.name=t,a.price=r,i=a)}),i},getCurrentItem:()=>e.currentItem,setCurrentItem:t=>(e.currentItem=t,e.currentItem),getElementById:t=>{let r;return e.items.forEach(e=>{e.id===t&&(r=e)}),r},getItems:()=>e.items,getTs:()=>{let t=0;return 0===e.items.length?t=0:e.items.forEach(e=>{t+=e.price}),e.totalSales=t,e.totalSales},addItem:(r,i)=>{let a;a=e.items.length>0?e.items[e.items.length-1].id+1:0,i=parseInt(i);const l=new t(a,r,i);return e.items.push(l),l}}})(),UiCtr=(()=>{const t={output:document.querySelector(".output"),submitContainer:document.querySelector(".submit"),submit:document.querySelector(".submit-input"),nameInput:document.querySelector(".name-input"),priceInput:document.querySelector(".calories-input"),buttons:document.querySelector(".edit-buttons"),editButton:document.querySelector(".item"),update:document.querySelector(".save"),delete:document.querySelector(".delete"),back:document.querySelector(".back"),section:document.querySelector(".calories-section"),clearAll:document.querySelector(".clear-all")};return{clearAll:()=>{Array.from(document.querySelectorAll(".output-item")).forEach(t=>{t.hasAttribute("id")&&t.remove()})},deleteItem:t=>{Array.from(document.querySelectorAll(".output-item")).forEach(e=>{if(e.hasAttribute("id")){e.getAttribute("id")==t&&e.remove()}})},updateItem:t=>{Array.from(document.querySelectorAll(".output-item")).forEach(e=>{if(e.hasAttribute("id")){e.getAttribute("id")==t.id&&(e.innerHTML=`\n            <div class="meal-item">${t.name}</div>\n            <div class="calorie-item">${t.price.toLocaleString()}</div>\n            <div class="item-edit">\n              <button class="item">Edit</button>\n            </div>\n            `)}})},fillInputField:e=>{t.nameInput.value=e.name,t.priceInput.value=e.price},showEditButtons:()=>{t.buttons.style.display="flex",t.submitContainer.style.display="none"},hideEditButtons:()=>{t.buttons.style.display="none",t.submitContainer.style.display="block"},hideListContainer:()=>{t.output.style.display="none"},clearInputs:()=>{t.nameInput.value="",t.priceInput.value=""},addNewItem:e=>{t.output.style.display="block";const r=document.createElement("li");r.className="output-item",r.id=`${e.id}`,r.innerHTML=`\n        <div class="meal-item">${e.name}</div>\n        <div class="calorie-item">${e.price.toLocaleString()}</div>\n        <div class="item-edit">\n          <button class="item">Edit</button>\n        </div>\n      `,t.output.append(r)},getInputValues:()=>({nameVal:document.querySelector(".name-input").value,priceVal:document.querySelector(".calories-input").value}),getUiElements:()=>t,updateSales:()=>{document.querySelector(".calories-content").textContent="$"+DataCtr.getTs().toLocaleString()},getAndPopulateList:e=>{for(let r=0;r<=e.length-1;r++)t.output.insertAdjacentHTML("beforeend",`\n        <li id='${e[r].id}' class="output-item">\n          <div class="meal-item">${e[r].name}</div>\n          <div class="calorie-item">${e[r].price.toLocaleString()}</div>\n          <div class="item-edit">\n            <button class="item">Edit</button>\n          </div>\n        </li>\n        `)}}})(),App=(()=>{const t=t=>{const e=UiCtr.getInputValues();if(""!==e.nameVal&&""!==e.priceVal){let t=DataCtr.addItem(e.nameVal,e.priceVal);Storage.addItemToStorage(t),UiCtr.addNewItem(t),UiCtr.clearInputs(),UiCtr.updateSales()}t.preventDefault()},e=t=>{if("item"===t.target.className){UiCtr.showEditButtons(),UiCtr.getUiElements().section.scrollIntoView(top);let e=parseInt(t.target.parentElement.parentElement.id);const r=DataCtr.getElementById(e);DataCtr.setCurrentItem(r),UiCtr.fillInputField(DataCtr.getCurrentItem())}t.preventDefault()},r=t=>{let e=UiCtr.getInputValues(),r=DataCtr.updateItem(e.nameVal,e.priceVal);UiCtr.updateItem(r),Storage.updateItem(r),UiCtr.clearInputs(),UiCtr.hideEditButtons(),UiCtr.updateSales(),t.preventDefault()},i=t=>{const e=DataCtr.getItems(),r=DataCtr.getCurrentItem();DataCtr.deleteItem(r.id),UiCtr.deleteItem(r.id),Storage.deleteItem(r),UiCtr.clearInputs(),UiCtr.hideEditButtons(),UiCtr.updateSales(),0===e.length&&UiCtr.hideListContainer()},a=t=>{DataCtr.clearAll(),UiCtr.clearAll(),UiCtr.updateSales(),UiCtr.hideListContainer(),Storage.clearAllItems()};return{init:()=>{const l=DataCtr.getItems();UiCtr.hideEditButtons(),0===l.length?UiCtr.hideListContainer():UiCtr.getAndPopulateList(DataCtr.getItems()),UiCtr.updateSales(),UiCtr.getUiElements().submit.addEventListener("click",t),UiCtr.getUiElements().output.addEventListener("click",e),document.addEventListener("keypress",t=>{if(13===t.keyCode||13===t.which)return t.preventDefault(),!1}),UiCtr.getUiElements().update.addEventListener("click",r),UiCtr.getUiElements().back.addEventListener("click",t=>{UiCtr.hideEditButtons(),UiCtr.clearInputs(),t.preventDefault()}),UiCtr.getUiElements().delete.addEventListener("click",i),UiCtr.getUiElements().clearAll.addEventListener("click",a)}}})();App.init();